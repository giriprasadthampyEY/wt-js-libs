<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [WTLibsError][1]
    -   [Parameters][2]
-   [WtJsLibs][3]
    -   [Parameters][4]
    -   [getDirectory][5]
        -   [Parameters][6]
    -   [getFactory][7]
        -   [Parameters][8]
    -   [getUpdateableOrganization][9]
        -   [Parameters][10]
    -   [getOrganization][11]
        -   [Parameters][12]
    -   [getTransactionsStatus][13]
        -   [Parameters][14]
    -   [createWallet][15]
        -   [Parameters][16]
    -   [getOffChainDataClient][17]
        -   [Parameters][18]
    -   [getTrustClueClient][19]
    -   [createInstance][20]
        -   [Parameters][21]
-   [errors][22]
-   [Wallet][23]
    -   [setupWeb3Eth][24]
        -   [Parameters][25]
    -   [isDestroyed][26]
    -   [getAddress][27]
    -   [unlock][28]
        -   [Parameters][29]
    -   [signAndSendTransaction][30]
        -   [Parameters][31]
    -   [signData][32]
        -   [Parameters][33]
    -   [lock][34]
    -   [destroy][35]
    -   [createInstance][36]
        -   [Parameters][37]
-   [Wallet][38]
    -   [Parameters][39]
    -   [setupWeb3Eth][40]
        -   [Parameters][41]
    -   [isDestroyed][42]
    -   [getAddress][43]
    -   [unlock][44]
        -   [Parameters][45]
    -   [signAndSendTransaction][46]
        -   [Parameters][47]
    -   [signData][48]
        -   [Parameters][49]
    -   [lock][50]
    -   [destroy][51]
    -   [createInstance][52]
        -   [Parameters][53]
-   [OffChainDataError][54]
-   [OffChainDataConfigurationError][55]
-   [OffChainDataRuntimeError][56]
-   [OffChainDataClient][57]
    -   [setup][58]
        -   [Parameters][59]
    -   [\_reset][60]
    -   [getAdapter][61]
        -   [Parameters][62]
-   [Contracts][63]
    -   [Parameters][64]
    -   [\_getInstance][65]
        -   [Parameters][66]
    -   [decodeLogs][67]
        -   [Parameters][68]
    -   [createInstance][69]
        -   [Parameters][70]
-   [SmartContractInstantiationError][71]
-   [InputDataError][72]
-   [StoragePointerError][73]
-   [RemotelyBackedDatasetError][74]
-   [RemoteDataAccessError][75]
-   [RemoteDataReadError][76]
-   [OrganizationNotFoundError][77]
-   [OrganizationNotInstantiableError][78]
-   [OnChainDataClient][79]
    -   [setup][80]
        -   [Parameters][81]
    -   [\_reset][82]
    -   [getDirectory][83]
        -   [Parameters][84]
    -   [getTransactionsStatus][85]
        -   [Parameters][86]
-   [OnChainOrganization][87]
    -   [Parameters][88]
    -   [initialize][89]
    -   [orgJson][90]
    -   [toPlainObject][91]
        -   [Parameters][92]
-   [RemotelyBackedDataset][93]
    -   [bindProperties][94]
        -   [Parameters][95]
    -   [isObsolete][96]
    -   [markObsolete][97]
    -   [isDeployed][98]
    -   [markDeployed][99]
    -   [\_genericGetter][100]
        -   [Parameters][101]
    -   [\_genericSetter][102]
        -   [Parameters][103]
    -   [updateRemoteData][104]
        -   [Parameters][105]
    -   [createInstance][106]
-   [add][107]
    -   [Parameters][108]
-   [remove][109]
    -   [Parameters][110]
-   [getOrganization][111]
    -   [Parameters][112]
-   [getOrganizations][113]
-   [StoragePointer][114]
    -   [Parameters][115]
    -   [reset][116]
    -   [\_detectSchema][117]
        -   [Parameters][118]
    -   [\_getOffChainDataClient][119]
    -   [\_initFromStorage][120]
        -   [Parameters][121]
    -   [\_downloadFromStorage][122]
    -   [toPlainObject][123]
        -   [Parameters][124]
    -   [createInstance][125]
        -   [Parameters][126]
-   [Utils][127]
    -   [Parameters][128]
    -   [isZeroAddress][129]
        -   [Parameters][130]
    -   [applyGasModifier][131]
        -   [Parameters][132]
    -   [getCurrentBlockNumber][133]
    -   [checkAddressChecksum][134]
        -   [Parameters][135]
    -   [determineCurrentAddressNonce][136]
        -   [Parameters][137]
    -   [getTransactionReceipt][138]
        -   [Parameters][139]
    -   [getTransaction][140]
        -   [Parameters][141]
    -   [createInstance][142]
        -   [Parameters][143]
-   [TrustClueError][144]
-   [TrustClueConfigurationError][145]
-   [TrustClueRuntimeError][146]
-   [TrustClueClient][147]
    -   [Parameters][148]
    -   [getClue][149]
        -   [Parameters][150]
    -   [getMetadataForAllClues][151]
    -   [getAllValues][152]
        -   [Parameters][153]
    -   [interpretAllValues][154]
        -   [Parameters][155]
    -   [verifySignedData][156]
        -   [Parameters][157]
    -   [createInstance][158]
        -   [Parameters][159]
-   [WalletError][160]
-   [MalformedWalletError][161]
-   [WalletStateError][162]
-   [WalletPasswordError][163]
-   [WalletSigningError][164]
-   [TransactionMiningError][165]
-   [OutOfGasError][166]
-   [InsufficientFundsError][167]
-   [TransactionRevertedError][168]
-   [TransactionDidNotComeThroughError][169]
-   [NoReceiptError][170]
-   [InaccessibleEthereumNodeError][171]

## WTLibsError

**Extends Error**

Generic WT Libs error.

### Parameters

-   `message`  
-   `originalError`  

## WtJsLibs

Main public interface of wt-libs-js.

### Parameters

-   `options`  

### getDirectory

Get an instance of Winding Tree directory from the OnChainDataClient.

#### Parameters

-   `segment`  allowed are `hotels` and `airlines`
-   `address`  of the Winding Tree index

### getFactory

Get an instance of Organization Factory on given address

#### Parameters

-   `address`  

### getUpdateableOrganization

Get a wrapper instance of updateable organizations, useful for changing on chain data

#### Parameters

-   `address` **\[type]** [description]

Returns **\[type]** [description]

### getOrganization

Get an instance of read-only organization wrapper

#### Parameters

-   `address`  

### getTransactionsStatus

Get a transactions status from the OnChainDataClient.
This method is async because it communicates directly with and EVM node.

#### Parameters

-   `transactionHashes`  

### createWallet

Returns a wallet instance for given JSON keystore.

#### Parameters

-   `jsonWallet`  

### getOffChainDataClient

Returns an off-chain data storage client that can be used for uploading
or downloading data stored off-chain.

#### Parameters

-   `schema`  

### getTrustClueClient

Returns a TrustClueClient instance configured with all of the clues
passed in the original library options.

### createInstance

Call this to create wt-libs-js instance.

#### Parameters

-   `options`  

Returns **any** WtJsLibs

## errors

A map of errors that WtJsLibs can throw, useful
for checking what happened in your code.

## Wallet

Export important classes for convenience.

### setupWeb3Eth

Sets up an initialized web3-eth instance for later use

#### Parameters

-   `provider`  

### isDestroyed

It is not possible to do any operations on a destroyed
wallet. Wallet is destroyed by calling the `destroy()` method.

### getAddress

Returns the address of the account passed in JSON
in a checksummed format, e.g. prefixed with 0x
and case-sensitive. Works only in an unlocked state,
because all other methods are unreliable.

-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When wallet is not unlocked.
-   Throws **[WalletStateError][172]** When there's no keystore.

### unlock

Unlocks/decrypts the JSON wallet keystore. <strong>From now on
there is a readable privateKey stored in memory!</strong>

#### Parameters

-   `password`  


-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When there is no web3-eth instance configured.
-   Throws **[WalletPasswordError][173]** When wallet cannot be decrypted.
-   Throws **[MalformedWalletError][174]** When wallet format is not recognized by web3-eth.
-   Throws **[WalletError][175]** When anything else breaks down during decryption. But
    that should actually never happen unless the web3-eth implementation is changed.

### signAndSendTransaction

Takes transaction data, signs them with an unlocked private key and sends them to
the network. Resolves either immediately after receiving a `transactionHash` (with hash) or after
a `receipt` event (with raw receipt object). This depends on passed eventCallbacks.
When onReceipt callback is present, Promise is resolved after `receipt` event

#### Parameters

-   `transactionData` **TransactionDataInterface** 
-   `eventCallbacks`  
-   `optional` **TransactionCallbacksInterface** callbacks called when events come back from the network


-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When there is no web3-eth instance configured.
-   Throws **[WalletStateError][172]** When wallet is not unlocked.
-   Throws **[WalletSigningError][176]** When transaction.from does not match the wallet account.
-   Throws **[NoReceiptError][177]** When there are issues with getting a transaction receipt.
-   Throws **[OutOfGasError][178]** When it seems transaction ran out of gas
-   Throws **[TransactionRevertedError][179]** When it seems transaction was reverted in EVM
-   Throws **[InsufficientFundsError][180]** When it seems there is not enough ETH in this wallet
-   Throws **[InaccessibleEthereumNodeError][181]** When it seems the network is unreachable
-   Throws **[TransactionMiningError][182]** When there's another error during the signing and mining process

Returns **[Promise][183]&lt;([string][184] | TxReceiptInterface)>** transaction hash

### signData

Signs a claim with a private key associated with this wallet.

#### Parameters

-   `claim`  


-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When wallet is not unlocked.
-   Throws **[WalletSigningError][176]** When something does not work during the actual signing

Returns **[Promise][183]&lt;[string][184]>** Hex encoded signature

### lock

Locks the wallet, i. e. deletes the private key from memory.
The original JSON keystore remains in the memory and can
be unlocked again if necessary.

This relies on the JS garbage collector, so please do not reference
the internal variables of this class elsewhere.

-   Throws **[WalletStateError][172]** When wallet was destroyed.

### destroy

Destroys the wallet. It first locks it, thus deleting
the private key from memory and then removes from
memory the JSON file.

This relies on the JS garbage collector, so please do not reference
the internal variables of this class elsewhere.

-   Throws **[WalletStateError][172]** When wallet was destroyed.

### createInstance

Creates an initialized instance

#### Parameters

-   `keystoreJsonV3`  

## Wallet

web3-eth based wallet implementation

### Parameters

-   `keystoreJsonV3`  

### setupWeb3Eth

Sets up an initialized web3-eth instance for later use

#### Parameters

-   `provider`  

### isDestroyed

It is not possible to do any operations on a destroyed
wallet. Wallet is destroyed by calling the `destroy()` method.

### getAddress

Returns the address of the account passed in JSON
in a checksummed format, e.g. prefixed with 0x
and case-sensitive. Works only in an unlocked state,
because all other methods are unreliable.

-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When wallet is not unlocked.
-   Throws **[WalletStateError][172]** When there's no keystore.

### unlock

Unlocks/decrypts the JSON wallet keystore. <strong>From now on
there is a readable privateKey stored in memory!</strong>

#### Parameters

-   `password`  


-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When there is no web3-eth instance configured.
-   Throws **[WalletPasswordError][173]** When wallet cannot be decrypted.
-   Throws **[MalformedWalletError][174]** When wallet format is not recognized by web3-eth.
-   Throws **[WalletError][175]** When anything else breaks down during decryption. But
    that should actually never happen unless the web3-eth implementation is changed.

### signAndSendTransaction

Takes transaction data, signs them with an unlocked private key and sends them to
the network. Resolves either immediately after receiving a `transactionHash` (with hash) or after
a `receipt` event (with raw receipt object). This depends on passed eventCallbacks.
When onReceipt callback is present, Promise is resolved after `receipt` event

#### Parameters

-   `transactionData` **TransactionDataInterface** 
-   `eventCallbacks`  
-   `optional` **TransactionCallbacksInterface** callbacks called when events come back from the network


-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When there is no web3-eth instance configured.
-   Throws **[WalletStateError][172]** When wallet is not unlocked.
-   Throws **[WalletSigningError][176]** When transaction.from does not match the wallet account.
-   Throws **[NoReceiptError][177]** When there are issues with getting a transaction receipt.
-   Throws **[OutOfGasError][178]** When it seems transaction ran out of gas
-   Throws **[TransactionRevertedError][179]** When it seems transaction was reverted in EVM
-   Throws **[InsufficientFundsError][180]** When it seems there is not enough ETH in this wallet
-   Throws **[InaccessibleEthereumNodeError][181]** When it seems the network is unreachable
-   Throws **[TransactionMiningError][182]** When there's another error during the signing and mining process

Returns **[Promise][183]&lt;([string][184] | TxReceiptInterface)>** transaction hash

### signData

Signs a claim with a private key associated with this wallet.

#### Parameters

-   `claim`  


-   Throws **[WalletStateError][172]** When wallet was destroyed.
-   Throws **[WalletStateError][172]** When wallet is not unlocked.
-   Throws **[WalletSigningError][176]** When something does not work during the actual signing

Returns **[Promise][183]&lt;[string][184]>** Hex encoded signature

### lock

Locks the wallet, i. e. deletes the private key from memory.
The original JSON keystore remains in the memory and can
be unlocked again if necessary.

This relies on the JS garbage collector, so please do not reference
the internal variables of this class elsewhere.

-   Throws **[WalletStateError][172]** When wallet was destroyed.

### destroy

Destroys the wallet. It first locks it, thus deleting
the private key from memory and then removes from
memory the JSON file.

This relies on the JS garbage collector, so please do not reference
the internal variables of this class elsewhere.

-   Throws **[WalletStateError][172]** When wallet was destroyed.

### createInstance

Creates an initialized instance

#### Parameters

-   `keystoreJsonV3`  

## OffChainDataError

**Extends WTLibsError**

Generic error related to off-chain stored data.

## OffChainDataConfigurationError

**Extends OffChainDataError**

An error occurred during a configuration of off-chain data storages.

## OffChainDataRuntimeError

**Extends OffChainDataError**

An error occurred during an attempt to use off-chain data storage.

## OffChainDataClient

OffChainDataClient is a static factory class that is responsible
for creating proper instances of OffChainDataAdapterInterface.
It is configured during the library initialization.

Please bear in mind, that once the adapters are configured, the
configuration is shared during the whole runtime.

### setup

Initializes the map of OffChainDataAdapters.

#### Parameters

-   `options`  
-   `OffChainDataClientOptionsType`  


-   Throws **[OffChainDataConfigurationError][185]** when there are multiple adapters with the same name

### \_reset

Drops all pre-configured OffChainDataAdapters. Useful for testing.

### getAdapter

Returns a fresh instance of an appropriate OffChainDataAdapter by
calling the `create` function from the adapter's configuration.

#### Parameters

-   `schema`  


-   Throws **[OffChainDataRuntimeError][186]** when schema is not defined or adapter for this schema does not exist

## Contracts

Wrapper class for work with Winding Tree's Ethereum
smart contracts.

### Parameters

-   `provider`  

### \_getInstance

Generic method for getting an instance of `web3.eth.Contract`.
Contracts are cached in memory based on the combination of name
and address.

#### Parameters

-   `name` **[string][184]** of contract, used in errors
-   `abi` **[Object][187]** specification of contract
-   `address` **[string][184]** on which we should look for the contract


-   Throws **[SmartContractInstantiationError][188]** When address is invalid
-   Throws **[SmartContractInstantiationError][188]** When no code is deployed on given address

Returns **web3.eth.Contract** Resulting wrapper contract

### decodeLogs

Decodes ethereum transaction log values. Currently supports
events from Directory and Hotel smart contracts.

#### Parameters

-   `logs` **[Array][189]&lt;RawLogRecordInterface>** in a raw format

Returns **[Array][189]&lt;DecodedLogRecordInterface>** Decoded logs

### createInstance

Returns an initialized instance

#### Parameters

-   `provider`  
-   `web3` **([string][184] \| [Object][187])** provider used to initialize web3-eth

Returns **[Contracts][190]** 

## SmartContractInstantiationError

**Extends WTLibsError**

A smart contract abstraction could not have been created.

## InputDataError

**Extends WTLibsError**

Input data has a wrong format or some data is missing.

## StoragePointerError

**Extends WTLibsError**

An error occurred when working with a StoragePointer.

## RemotelyBackedDatasetError

**Extends WTLibsError**

Generic error that occurrs during any work with RemotelyBackedDataset.

## RemoteDataAccessError

**Extends RemotelyBackedDatasetError**

It is impossible to access remote data (i. e. the data is in bad state).

## RemoteDataReadError

**Extends RemotelyBackedDatasetError**

It is impossible to read from remote data (i. e. the connection might have been lost).

## OrganizationNotFoundError

**Extends WTLibsError**

Organization is not found in WTIndex for some reason.

## OrganizationNotInstantiableError

**Extends WTLibsError**

Organization abstraction instance cannot be created for some reason.

## OnChainDataClient

A factory class used to access various on-chain data
represented by Winding Tree index.

### setup

Sets up Utils and Contracts with given web3 provider.
Sets up gasCoefficient or gasMargin. If neither is provided,
sets gasCoefficient to a default of 2.

#### Parameters

-   `options`  

### \_reset

Deletes options and dataModels. Useful for testing.

### getDirectory

Returns a cached instance of `AbstractDataModel`
for given segment

#### Parameters

-   `segment`  allowed values are hotels and airlines
-   `address`  


-   Throws **any** OnChainDataRuntimeError when an unknown segment is encountered.

### getTransactionsStatus

Finds out in what state are Ethereum transactions. All logs
are decoded along the way and some metrics such as min/max blockAge
are computed. If you pass all transactions related to a single
operation (such as update), you may benefit from the computed
metrics.

#### Parameters

-   `txHashes`  

## OnChainOrganization

Wrapper class for a an organization backed by a smart contract on
Ethereum that's holding `orgJsonUri` pointer to its data.

This is meant as a read only wrapper.

It provides an accessor to such data in a form of
`StoragePointer` instance under `orgJson` property.
Every schema-specific implementation details
are dealt with in StoragePointer.

### Parameters

-   `web3Utils`  
-   `web3Contracts`  
-   `address`  

### initialize

Initializes the underlying RemotelyBackedDataset that actually
communicates with the on-chain stored data. If address was provided
in the contsructor, the RemotelyBackedDataset is marked as deployed
and can be used instantly.

### orgJson

Async getter for `StoragePointer` instance.
Since it has to eventually access the `orgJsonUri`
field stored on-chain, it is lazy loaded.

### toPlainObject

Helper method that transforms the whole Organization into a sync simple
JavaScript object only with data properties.

By default, all off-chain data is resolved recursively. If you want to
limit off-chain data only to a certain subtree, use the resolvedFields
parameter that accepts an array of paths in dot notation (`father.son.child`).
Every last piece of every path will be resolved recursively as well. An empty
list means no fields will be resolved.

Properties that represent an actual separate document have a format of

    {
      'ref': 'schema://original-url',
      'contents': {
        'actual': 'data'
      }
    }

#### Parameters

-   `resolvedFields` **[Array][189]&lt;[string][184]>** List of fields to be resolved from off chain data, in dot notation.
    If an empty array is provided, no resolving is done. If the argument is missing, all fields are resolved.
-   `depth` **[number][191]** Number of levels to resolve. See `StoragePointer` jsDocs for more info.


-   Throws **[StoragePointerError][192]** when an adapter encounters an error while accessing the data

## RemotelyBackedDataset

Dataset ready to use various strategies for storing the data
in a remote storage. Every field backed by this strategy should
have a getter and setter defined that interacts with the
remote storage. The dataset strategy may be in the following states:

-   fresh - Purely in-memory created object with no data
-   unsynced - Some data may be set locally, but they were not
    propagated to the remote storage, and no data was loaded from the
    remote storage.
-   deployed - Data has its representation ready on the remote storage
    and we may call remote getters and setters to interact with the remote storage.
-   obsolete - Data lost its representation on the remote storage and
    we should not interact with it anymore.

Internally a state is held for each property. If you `get` a property
that was not previously accessed, the whole dataset gets synced (this might
get more efficient in the future), and you get a current value from
the remote storage. If any value was changed locally, it is considered
as the current value. Once you are done with data modification, you
have to call `updateRemoteData` that propagates the whole dataset to the
remote storage. These calls are deduplicated, so if a single call is used
to update multiple properties, only once call is done.

### bindProperties

Creates generic getters and setters that proxy `remoteGetter` and
`remoteSetter` when necessary.

The fields are specified as an `options.fields` property and every key
represents a single property. Every property's options can than hold
a `remoteGetter` and `remoteSetter` field such as

    {fields: {
        orgJsonUri: {
          remoteGetter: async (): Promise<?string> => {
            return (await this.contract.orgJsonUri().call();
          },
          // this will usually return a transaction ID
          remoteSetter: async (): Promise<string> => {
            return this.contract.methods.callHotel(this.address, data).send(txOptions);
          }
    },

All passed fields are set as unsynced which means that
after the first `get` on any of those, the whole dataset will
be synced from the remote storage (if the dataset is marked as deployed).

#### Parameters

-   `options` **[Object][187]** `{fields: {[field]: fieldOptions}}`
-   `bindTo` **[Object][187]** Object to which the properties will be bound.
    Typically the initiator of this operation.

### isObsolete

Is dataset marked as obsolete?

Returns **[Boolean][193]** 

### markObsolete

Marks dataset as obsolete. Typically called after the remote storage
is destroyed or made inaccessible. This is not propagated anywhere
but merely serves as a flag to prevent further interaction with this object.

### isDeployed

Is dataset deployed to the remote storage?

Returns **[Boolean][193]** 

### markDeployed

Marks dataset as deployed. Typically called when the remote
storage is set up, created or connected to.

### \_genericGetter

Tries to get a value. If the property was not synced before,
it will sync the whole dataset from a remote storage. If a property
was modified locally before, the modified value will be returned.

#### Parameters

-   `property` **[string][184]** 


-   Throws **[RemoteDataAccessError][194]** When dataset is marked as obsolete

Returns **any** property's current value

### \_genericSetter

Sets a new value locally and marks the property as dirty. Thath
means that even after syncing data from remote storage, the object will still
serve the locally modified value.

#### Parameters

-   `property` **[string][184]** 
-   `newValue` **any** 

### updateRemoteData

Calls all remoteSetters if relevant data was changed.
Calls are deduplicated, so if the same method would be used
to update multiple fields, it is called only once.

#### Parameters

-   `transactionOptions` **[Object][187]** passed to every remoteSetter, typically something like `{from: address, to: address}`

Returns **[Array][189]&lt;any>** Results of remoteSetters, it would typically contain transaction metadata. In any case, an eventCallbacks
object is appended to every result and onReceipt callback is added to ensure that data fields would eventually be properly marked as 'synced'.

### createInstance

Generic factory method.

## add

Generates transaction data required for adding an organization
and more metadata required for sucessful mining of that transaction.
Does not sign or send the transaction.

### Parameters

-   `orgData`  


-   Throws **[InputDataError][195]** When orgData does not contain orgJsonUri property.
-   Throws **[InputDataError][195]** When orgData does not contain a owner property.
-   Throws **[WTLibsError][196]** When anything goes wrong during data preparation phase.

## remove

Generates transaction data required for removing an organization
and more metadata required for successful mining of that transaction.
Does not sign or send the transaction.

### Parameters

-   `orgData`  


-   Throws **[InputDataError][195]** When organization does not contain orgJsonUri property.
-   Throws **[InputDataError][195]** When organization does not contain a owner property.
-   Throws **[WTLibsError][196]** When anything goes wrong during data preparation phase.

## getOrganization

Gets organization representation of a organization on a given address. If organization
on such address is not registered through this Winding Tree index
instance, the method throws immediately.

### Parameters

-   `address`  


-   Throws **[OrganizationNotFoundError][197]** When organization does not exist.
-   Throws **[OrganizationNotInstantiableError][198]** When the organization class cannot be constructed.
-   Throws **[WTLibsError][196]** When something breaks in the network communication.

## getOrganizations

Returns a list of all organizations. It will filter out
every organization that is inaccessible for any reason.

Currently any inaccessible organization is silently ignored.
Subject to change.

## StoragePointer

`StoragePointer` serves as a representation of an
off-chain document holding JSON data. This generic class
does not enforce any protocol/schema and contains
infrastructure code that helps to set up field definition
and getters for every data field. It does not provide any
means of writing data, its sole purpose is for reading.

It is possible to use this recursively, so you can define
a field as another storage pointer. The configuration is
declarative and may look like this:

    const pointer = StoragePointer.createInstance('some://url');
    pointer.ref; // contains 'some://url',
    contents = await pointer.contents;
    contents.name;
    contents.description;
    // etc.

Or in recursive cases:

    const pointer = StoragePointer.createInstance('some://url', {
      description: {
        required: false,
      },
    });
    pointer.ref; // contains  'some://url'
    contents = await pointer.contents;
    contents.signature;
    const descPointer = contents.description;
    descPointer.ref; // contains whatever is written in a description property in a document located on 'some://url'
    descContents = await descPointer.contents; // data from descPointer.ref

so if you mark a storage pointer as not required, the library will not crash if the field
is missing or nulled.

Only subordinate storage pointers (`children`) have to be defined beforehand, so the `signature`
field above may contain a complex JSON object.

Recursion is supported, if described in `children` definition.
See [test][199] for a working example.

    const innerUri = InMemoryAdapter.storageInstance.create({
      data: 'wt',
    });
    const outerUri = InMemoryAdapter.storageInstance.create({
      detail: `in-memory://${innerUri}`,
      bar: 'foo',
    });
    const pointer = StoragePointer.createInstance(`in-memory://${outerUri}`, {
      detail: {
        children: {},
      },
    });
    pointer.ref; // contains outerUri
    let contents = await pointer.contents;
    contents.bar; // contains 'foo'
    contents.detail.ref; // contains innerUri
    (await contents.detail.contents).data; // contains 'wt'. See `toPlainObject` if you want to avoid multiple `await` clauses.

StoragePointers in arrays are also supported, see [an example][200].
Note that arrays are not supported for `nested` children types.

### Parameters

-   `uri` **[string][184]** where to look for the data
-   `children` **ChildrenType** subordinate storage pointers

### reset

Reset the storage pointer, thus forcing it to lazily
download the data again.

Usable when the the off-chain data might have changed since
the last query and the most recent version of it is needed.

### \_detectSchema

Detects schema from an uri, i. e.
from `schema://some-data`, detects `schema`.

#### Parameters

-   `uri`  

### \_getOffChainDataClient

Returns appropriate implementation of `OffChainDataAdapterInterface`
based on schema. Uses `OffChainDataClient.getAdapter` factory method.

### \_initFromStorage

Sets the internal \_data property based on the data retrieved from
the storage.

#### Parameters

-   `data`  

### \_downloadFromStorage

Gets the data document via `OffChainDataAdapterInterface`
and uses it to initialize the internal state.

### toPlainObject

Recursively transforms the off chain stored document to a sync plain
javascript object. By default, traverses the whole document tree.

You can limit which branches will get downloaded by providing a `resolvedFields`
argument which acccepts a list of paths in dot notation (`father.son.child`).
Every child will then get resolved recursively.

If you don't want some paths to get downloaded, just provide at least one sibling
field on that level which is not a `StoragePointer`. An empty list means no fields
will be resolved.

Data always gets downloaded if this method is called.

The resulting structure mimicks the original `StoragePointer` data structure:

    {
      'ref': 'schema://url',
      'contents': {
        'field': 'value',
        'storagePointer': {
          'ref': 'schema://originalUri',
          'contents': {
             'field': 'value'
          }
        },
        'storagePointers': [ // pointers in arrays are resolved as well
          {
            'ref': 'schema://originalUri1',
            'contents': {
               'field': 'value1'
            }
          },{
            'ref': 'schema://originalUri2',
            'contents': {
               'field': 'value2'
            }
          }
        ],
        'unresolvedStoragePointer': 'schema://unresolved-url'
      }
    }

#### Parameters

-   `resolvedFields` **[Array][189]&lt;[string][184]>** List of fields that limit the resulting dataset in dot notation (`father.child.son`).
     If an empty array is provided, no resolving is done. If the argument is missing, all fields are resolved.
     You don't need to specify path to a field in any special way when it is in an array (e.g. storagePointers.0.field or similar).
     Array items are resolved as if they're on the array level (i.e. storagePointers.field).
-   `depth` **integer** Number of levels to resolve in case no `resolvedFields` are specified on a level anymore.
     Note that calling `toPlainObject` with specified fields may lead to fields being not specified in recursive calls
     (e.g. when calling `toPlainObject(['a.b'])` all fields in data.a.b will be resolved - unless limited by depth). (optional, default `9999`)


-   Throws **[StoragePointerError][192]** when an adapter encounters an error while accessing the data

### createInstance

Returns a new instance of StoragePointer.

Normalizes the `fields` format before creating the actual
instance

#### Parameters

-   `uri` **[string][184]** where to look for data document. It has to include schema, i. e. `https://example.com/data`
-   `children` **ChildrenType** subordinate storage pointers

## Utils

Collection of utility methods useful during
communication with Ethereum network.

### Parameters

-   `gasModifiers`  
-   `provider`  

### isZeroAddress

Is address a zero address? Uses a string comparison.
Returns true also for strings that are not a valid address.

#### Parameters

-   `address`  

Returns **[boolean][193]** 

### applyGasModifier

Modifies the gas with a previously configured `gasCoefficient`
or `gasMargin`.

#### Parameters

-   `gas` **[number][191]** 

Returns **[number][191]** modified gas

### getCurrentBlockNumber

Proxy method for `web3.eth.getBlockNumber`

### checkAddressChecksum

Proxy method for `web3.eth.checkAddressChecksum`

#### Parameters

-   `address`  

### determineCurrentAddressNonce

Returns current number of transactions mined for given
Ethereum address

#### Parameters

-   `address` **[string][184]** 

Returns **any** number

### getTransactionReceipt

Proxy method for `web3.eth.getTransactionReceipt`

#### Parameters

-   `txHash` **[string][184]** 

Returns **TxReceiptInterface** 

### getTransaction

Proxy method for `web3.eth.getTransaction`

#### Parameters

-   `txHash`  

### createInstance

Returns an initialized instance

#### Parameters

-   `gasModifiers`  
-   `provider`  
-   `gasCoefficient` **GasModifiersType** or gasMargin that can be applied
    to outgoing transactions.
-   `web3` **([string][184] \| [Object][187])** instance provider used to create web3-eth

Returns **[Utils][201]** 

## TrustClueError

**Extends WTLibsError**

Generic error related to a trust clue.

## TrustClueConfigurationError

**Extends TrustClueError**

An error occurred during a configuration of trust clues.

## TrustClueRuntimeError

**Extends TrustClueError**

An error occurred during an attempt to use trust clues.

## TrustClueClient

TrustClueClient is a static factory class that is responsible
for creating proper instances of `TrustClueInterface`s.
It is configured during the library initialization.

Please bear in mind, that once the clues are configured, the
configuration is shared during the whole runtime.

### Parameters

-   `options`  

### getClue

Returns a fresh instance of an appropriate TrustClue by
calling the `create` function from the clue's configuration.

#### Parameters

-   `name`  


-   Throws **[TrustClueRuntimeError][202]** when name is not defined or a clue with such name does not exist

### getMetadataForAllClues

Returns a list of metadata for all clues.

### getAllValues

Walks over all clues and collects their values.

#### Parameters

-   `address` **[string][184]** Ethereum address for which the values should
    be collected.

Returns **any** A list of objects with either value or error:
`{name: clue-name, value: value, error: error message}`

### interpretAllValues

Walks over all clues and collects their interpreted values.

#### Parameters

-   `address` **[string][184]** Ethereum address for which the values should
    be collected.

Returns **any** A list of objects with either value or error:
`{name: clue-name, value: value, error: error message}`

### verifySignedData

Verifies the signature and actual signer.

#### Parameters

-   `serializedData` **[string][184]** String data to be signed.
-   `signature` **[string][184]** Strictly hex encoded (starting with 0x) signature of `serializedData`.
-   `verificationFn` **[function][203]** Optional verification function. Is called with the actual
    signer and should throw when verification fails. The return value is ignored.
    Default: Parse `serializedData` as JSON and compare the actual signer to checksum
    address of the `signer` field.Default verification fn expects the `serializedData` is string containing JSON with `signer` field
    Provide custom `verificationFn` if needed.


-   Throws **[TrustClueRuntimeError][202]** When any of arguments is missing, or the signature recovery
    fails or the signature verification fails or any other error occurs.

### createInstance

Initializes the map of `TrustClue`s.

#### Parameters

-   `options`  
-   `TrustClueClientOptionsType`  


-   Throws **[TrustClueConfigurationError][204]** when there are multiple clues with the same name

## WalletError

**Extends WTLibsError**

Some error occurred in the wallet abstraction.

## MalformedWalletError

**Extends WalletError**

Thrown when a wallet cannot be decrypted by web3 due to its format
or bad parameters.

## WalletStateError

**Extends WalletError**

Thrown when an operation is performed with a wallet
that can not be currently done due to its internal state.

## WalletPasswordError

**Extends WalletError**

Wallet cannot be decrypted because of a bad password.

## WalletSigningError

**Extends WalletError**

Error occured during signing a transaction, that might
mean that the wallet can't sign the transaction data,
because tx.from does not match the wallet's address.

## TransactionMiningError

**Extends WTLibsError**

Generic error that happens when no special case is
detected during transaction mining error throw by web3.js

## OutOfGasError

**Extends TransactionMiningError**

Transaction supposedly ran out of gas and was not mined.
This depends on how precisely the error is reported by EVM
and subsequently web3.js

## InsufficientFundsError

**Extends TransactionMiningError**

Transaction supposedly was not mined because the originating
account does not have enough funds.
This depends on how precisely the error is reported by EVM
and subsequently web3.js

## TransactionRevertedError

**Extends TransactionMiningError**

Transaction was supposedly reverted and was not mined.
This depends on how precisely the error is reported by EVM
and subsequently web3.js

## TransactionDidNotComeThroughError

**Extends TransactionMiningError**

Transaction did not go into mining at all. It might be due to
an existing transaction with the same ID or because you tried
to replace an existing transaction with less gas.

## NoReceiptError

**Extends TransactionMiningError**

There was a problem with getting a transaction receipt (network issue,
timeout, small gasPrice). It does not necessarily mean that the
transaction was not mined. You should probably check for it by other means.
This depends on how precisely the error is reported by EVM
and subsequently web3.js

## InaccessibleEthereumNodeError

**Extends TransactionMiningError**

There was a problem with communicating with the Ethereum node.
The library has literally zero idea about what really happened with the
transaction.

[1]: #wtlibserror

[2]: #parameters

[3]: #wtjslibs

[4]: #parameters-1

[5]: #getdirectory

[6]: #parameters-2

[7]: #getfactory

[8]: #parameters-3

[9]: #getupdateableorganization

[10]: #parameters-4

[11]: #getorganization

[12]: #parameters-5

[13]: #gettransactionsstatus

[14]: #parameters-6

[15]: #createwallet

[16]: #parameters-7

[17]: #getoffchaindataclient

[18]: #parameters-8

[19]: #gettrustclueclient

[20]: #createinstance

[21]: #parameters-9

[22]: #errors

[23]: #wallet

[24]: #setupweb3eth

[25]: #parameters-10

[26]: #isdestroyed

[27]: #getaddress

[28]: #unlock

[29]: #parameters-11

[30]: #signandsendtransaction

[31]: #parameters-12

[32]: #signdata

[33]: #parameters-13

[34]: #lock

[35]: #destroy

[36]: #createinstance-1

[37]: #parameters-14

[38]: #wallet-1

[39]: #parameters-15

[40]: #setupweb3eth-1

[41]: #parameters-16

[42]: #isdestroyed-1

[43]: #getaddress-1

[44]: #unlock-1

[45]: #parameters-17

[46]: #signandsendtransaction-1

[47]: #parameters-18

[48]: #signdata-1

[49]: #parameters-19

[50]: #lock-1

[51]: #destroy-1

[52]: #createinstance-2

[53]: #parameters-20

[54]: #offchaindataerror

[55]: #offchaindataconfigurationerror

[56]: #offchaindataruntimeerror

[57]: #offchaindataclient

[58]: #setup

[59]: #parameters-21

[60]: #_reset

[61]: #getadapter

[62]: #parameters-22

[63]: #contracts

[64]: #parameters-23

[65]: #_getinstance

[66]: #parameters-24

[67]: #decodelogs

[68]: #parameters-25

[69]: #createinstance-3

[70]: #parameters-26

[71]: #smartcontractinstantiationerror

[72]: #inputdataerror

[73]: #storagepointererror

[74]: #remotelybackeddataseterror

[75]: #remotedataaccesserror

[76]: #remotedatareaderror

[77]: #organizationnotfounderror

[78]: #organizationnotinstantiableerror

[79]: #onchaindataclient

[80]: #setup-1

[81]: #parameters-27

[82]: #_reset-1

[83]: #getdirectory-1

[84]: #parameters-28

[85]: #gettransactionsstatus-1

[86]: #parameters-29

[87]: #onchainorganization

[88]: #parameters-30

[89]: #initialize

[90]: #orgjson

[91]: #toplainobject

[92]: #parameters-31

[93]: #remotelybackeddataset

[94]: #bindproperties

[95]: #parameters-32

[96]: #isobsolete

[97]: #markobsolete

[98]: #isdeployed

[99]: #markdeployed

[100]: #_genericgetter

[101]: #parameters-33

[102]: #_genericsetter

[103]: #parameters-34

[104]: #updateremotedata

[105]: #parameters-35

[106]: #createinstance-4

[107]: #add

[108]: #parameters-36

[109]: #remove

[110]: #parameters-37

[111]: #getorganization-1

[112]: #parameters-38

[113]: #getorganizations

[114]: #storagepointer

[115]: #parameters-39

[116]: #reset

[117]: #_detectschema

[118]: #parameters-40

[119]: #_getoffchaindataclient

[120]: #_initfromstorage

[121]: #parameters-41

[122]: #_downloadfromstorage

[123]: #toplainobject-1

[124]: #parameters-42

[125]: #createinstance-5

[126]: #parameters-43

[127]: #utils

[128]: #parameters-44

[129]: #iszeroaddress

[130]: #parameters-45

[131]: #applygasmodifier

[132]: #parameters-46

[133]: #getcurrentblocknumber

[134]: #checkaddresschecksum

[135]: #parameters-47

[136]: #determinecurrentaddressnonce

[137]: #parameters-48

[138]: #gettransactionreceipt

[139]: #parameters-49

[140]: #gettransaction

[141]: #parameters-50

[142]: #createinstance-6

[143]: #parameters-51

[144]: #trustclueerror

[145]: #trustclueconfigurationerror

[146]: #trustclueruntimeerror

[147]: #trustclueclient

[148]: #parameters-52

[149]: #getclue

[150]: #parameters-53

[151]: #getmetadataforallclues

[152]: #getallvalues

[153]: #parameters-54

[154]: #interpretallvalues

[155]: #parameters-55

[156]: #verifysigneddata

[157]: #parameters-56

[158]: #createinstance-7

[159]: #parameters-57

[160]: #walleterror

[161]: #malformedwalleterror

[162]: #walletstateerror

[163]: #walletpassworderror

[164]: #walletsigningerror

[165]: #transactionminingerror

[166]: #outofgaserror

[167]: #insufficientfundserror

[168]: #transactionrevertederror

[169]: #transactiondidnotcomethrougherror

[170]: #noreceipterror

[171]: #inaccessibleethereumnodeerror

[172]: #walletstateerror

[173]: #walletpassworderror

[174]: #malformedwalleterror

[175]: #walleterror

[176]: #walletsigningerror

[177]: #noreceipterror

[178]: #outofgaserror

[179]: #transactionrevertederror

[180]: #insufficientfundserror

[181]: #inaccessibleethereumnodeerror

[182]: #transactionminingerror

[183]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[184]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[185]: #offchaindataconfigurationerror

[186]: #offchaindataruntimeerror

[187]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[188]: #smartcontractinstantiationerror

[189]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[190]: #contracts

[191]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[192]: #storagepointererror

[193]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[194]: #remotedataaccesserror

[195]: #inputdataerror

[196]: #wtlibserror

[197]: #organizationnotfounderror

[198]: #organizationnotinstantiableerror

[199]: https://github.com/windingtree/wt-js-libs/blob/8fdfe3aed7248fd327b60f1a56f0d3a3b1d3e93b/test/wt-libs/storage-pointer.spec.js#L448

[200]: https://github.com/windingtree/wt-js-libs/blob/8fdfe3aed7248fd327b60f1a56f0d3a3b1d3e93b/test/wt-libs/storage-pointer.spec.js#L427

[201]: #utils

[202]: #trustclueruntimeerror

[203]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[204]: #trustclueconfigurationerror
